{"status":{},"spec":{"name":"demo-runbook","description":"","resources":{"runbook":{"name":"5aaea70e_runbook","description":"","task_definition_list":[{"type":"DAG","name":"4dae8ff4_dag","description":"","attrs":{"type":"","edges":[{"type":"","from_task_reference":{"name":"Get Super Admin extId","kind":"app_task"},"to_task_reference":{"name":"Create Service Account","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Create Service Account","kind":"app_task"},"to_task_reference":{"name":"Create API Key","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Create API Key","kind":"app_task"},"to_task_reference":{"name":"Create Authorization Policy","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Create Authorization Policy","kind":"app_task"},"to_task_reference":{"name":"List VMs with API Key Authentication","kind":"app_task"},"edge_type":"user_defined"}]},"child_tasks_local_reference_list":[{"name":"Get Super Admin extId","kind":"app_task"},{"name":"Create Service Account","kind":"app_task"},{"name":"Create API Key","kind":"app_task"},{"name":"Create Authorization Policy","kind":"app_task"},{"name":"List VMs with API Key Authentication","kind":"app_task"}],"variable_list":[],"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"HTTP","name":"Get Super Admin extId","description":"","attrs":{"type":"","method":"GET","connection_timeout":120,"headers":[],"url":"","request_body":"","content_type":"application\/json","expected_response_params":[{"type":"","status":"SUCCESS","code_range_list":[{"start_code":200,"end_code":200}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":400,"end_code":400}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":409,"end_code":409}]}],"authentication":{"type":"none"},"response_paths":{"SUPER_ADMIN_EXTID":"$.data[0].extId"},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":10,"internal_service":"","internal_service_method":"","relative_url":"\/authz\/roles?$filter=displayName%20eq%20'Super%20Admin'"},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"prism_central_iam","kind":"app_endpoint"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"HTTP","name":"Create Service Account","description":"","attrs":{"type":"","method":"POST","connection_timeout":120,"headers":[],"url":"","request_body":"{\n    \"username\": \"api_key_service_account\",\n    \"userType\": \"SERVICE_ACCOUNT\",\n    \"displayName\": \"API key service account\",\n    \"firstName\": \"Service\",\n    \"lastName\": \"Account\",\n    \"emailId\": \"service_account@acme.com\",\n    \"status\": \"ACTIVE\",\n    \"description\": \"Service account for API key authentication\",\n    \"creationType\": \"USERDEFINED\"\n}","content_type":"application\/json","expected_response_params":[{"type":"","status":"SUCCESS","code_range_list":[{"start_code":201,"end_code":201}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":400,"end_code":400}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":409,"end_code":409}]}],"authentication":{"type":"none"},"response_paths":{"SERVICE_ACCOUNT_EXTID":"$.data.extId"},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":10,"internal_service":"","internal_service_method":"","relative_url":"\/authn\/users"},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"prism_central_iam","kind":"app_endpoint"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"HTTP","name":"Create API Key","description":"","attrs":{"type":"","method":"POST","connection_timeout":120,"headers":[],"url":"","request_body":"{\n    \"name\": \"service_account_api_key\",\n    \"keyType\": \"API_KEY\"\n}","content_type":"application\/json","expected_response_params":[{"type":"","status":"SUCCESS","code_range_list":[{"start_code":201,"end_code":201}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":400,"end_code":400}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":409,"end_code":409}]}],"authentication":{"type":"none"},"response_paths":{"API_KEY":"$.data.keyDetails.apiKey"},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":10,"internal_service":"","internal_service_method":"","relative_url":"\/authn\/users\/@@{SERVICE_ACCOUNT_EXTID}@@\/keys"},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"prism_central_iam","kind":"app_endpoint"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"HTTP","name":"Create Authorization Policy","description":"","attrs":{"type":"","method":"POST","connection_timeout":120,"headers":[],"url":"","request_body":"{\n    \"displayName\": \"API Key Auth Policy\",\n    \"description\": \"Authorization policy for use with API key service accounts\",\n    \"entities\": [\n        {\n            \"$reserved\": {\n                \"*\": {\n                    \"*\": {\n                        \"eq\": \"*\"\n                    }\n                }\n            }\n        }\n    ],   \n    \"identities\": [\n        {\n            \"$reserved\": {\n                \"user\": {\n                    \"uuid\": {\n                        \"anyof\": [\n                            \"@@{SERVICE_ACCOUNT_EXTID}@@\"\n                        ]\n                    }\n                }\n            }\n        }\n    ],\n    \"role\": \"@@{SUPER_ADMIN_EXTID}@@\"\n}","content_type":"application\/json","expected_response_params":[{"type":"","status":"SUCCESS","code_range_list":[{"start_code":201,"end_code":201}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":400,"end_code":400}]},{"type":"","status":"FAILURE","code_range_list":[{"start_code":409,"end_code":409}]}],"authentication":{"type":"none"},"response_paths":{},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":10,"internal_service":"","internal_service_method":"","relative_url":"\/authz\/authorization-policies"},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"prism_central_iam","kind":"app_endpoint"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"HTTP","name":"List VMs with API Key Authentication","description":"","attrs":{"type":"","method":"GET","connection_timeout":120,"headers":[{"type":"LOCAL","name":"X-NTNX-API-KEY","description":"","regex":{},"options":{},"is_hidden":false,"is_mandatory":false,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"state":"NOT_VALIDATED","message_list":[],"editables":{},"value":"@@{API_KEY}@@"}],"url":"","request_body":"","content_type":"application\/json","expected_response_params":[{"type":"","status":"SUCCESS","code_range_list":[{"start_code":200,"end_code":200}]}],"authentication":{"type":"none"},"response_paths":{},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":10,"internal_service":"","internal_service_method":"","relative_url":"\/ahv\/config\/vms?$limit=3"},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"prism_central_vmm","kind":"app_endpoint"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"4dae8ff4_dag","kind":"app_task"},"variable_list":[{"type":"LOCAL","name":"PC_IP","description":"Prism Central IP or FQDN","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":true,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"editables":{"value":true},"value":"10.0.0.1"}],"output_variable_list":[{"type":"LOCAL","name":"SERVICE_ACCOUNT_EXTID","description":"extId for the new user account of type \"Service Account\"","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":false,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"value":""},{"type":"LOCAL","name":"SUPER_ADMIN_EXTID","description":"extId for the IAM role named \"Super Admin\"","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":false,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"value":""},{"type":"LOCAL","name":"API_KEY","description":"One-time access to the API key that is created and assigned to the new user","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":false,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"value":""}]},"endpoint_definition_list":[],"credential_definition_list":[],"default_target_reference":{"name":"prism_central_iam","kind":"app_endpoint"},"endpoints_information":[],"client_attrs":{}}},"api_version":"3.0","product_version":"4.2.0","metadata":{"last_update_time":"1752208749948011","creation_time":"1746063433820252","spec_version":9,"name":"demo-runbook","kind":"runbook"},"contains_secrets":false}